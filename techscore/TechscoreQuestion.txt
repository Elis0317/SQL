Q3-1
表 3-1 に示す列を持ったテーブル employee を定義する SQL 文を書きなさい。
それぞれの列のデータ型等の情報は表 3-2 に、制約は表 3-3 に示すとおりである。

表 3-1: テーブル employee e_num 	e_name 	year 	gender 	office

表 3-2: 社員テーブルのデータ型など 列名 	説明
e_num 	従業員ナンバー、固定長文字列、文字列の長さ 4、主キー
e_name 	従業員名、可変長文字列、最大文字列の長さ 40
year 	入社年、整数型
gender 	性別、固定長文字列（'0'，'1'）、文字列の長さ 1
office 	所属営業所番号、固定長文字列、文字列の長さ 2

表 3-3: 制約 列名 	制約
e_name 	NOT NULL 制約
year 	データの入力時に、1970 より小さい値は受け付けない
gender 	データの入力時に、'0' または '1' 以外の値は受け付けない 


Q3-3
3-1で定義したテーブル employee に次のテーブル制約を加えるための SQL を記述しなさい。

テーブル office の列 o_num を親キーとする外部キーを列 office に設定する


Q4-1
テーブル employee に次のデータを挿入する SQL 文を記述しなさい。

表 4-2: 挿入するデータ
e_num 	e_name 	year 	gender 	office
101 	Ato Taro 	1972 	1 	10


Q4-2
4-1で入力したデータの office を、10 から 20 に変更するときの SQL 文を記述しなさい。


Q4-3
テーブル employee のデータをすべて削除するときの SQL 文を記述しなさい。

Q5-1 OK!
表に示すテーブル employee の e_name 列から、
ファーストネームが「To」で始まるものだけを表示する SQL 文を記述しなさい。
表示する列は、e_name 列のみでよい。
ただし e_name 列は「ラストネーム ファーストネーム」なるデータが格納されているものとする。


Q5-2　OK!
テーブルemployeeから、それぞれの事務所の男性の人数を求めるための SQL 文を記述しなさい。
表示する列は、「office」及び「男性の人数」である。
gender 列で、'0' は女性、'1' は男性を表す。 


Q6-1 OK!
ある自動車メーカーの販売管理データベース(http://www.techscore.com/tech/sql/db.html/)
に用意されているテーブル customer と office から、
各営業所が抱えている顧客が何名いるのかを確認する SQL 文を記述しなさい。

営業所名と顧客の人数、と表示すること。


Q6-2 OK!
販売管理データベースから、支払った金額の大きいもの順に、
顧客名と支払った合計金額を表示する SQL 文を記述しなさい。
一回あたりの支払い金額は、次の式で求めるものとする。
複数台自動車を購入した顧客はそれらすべてを合計したものを支払い金額とする。

(製品の価格) x (100 - (製品の値引率)) / 100 + (オプションの価格)
    = product.price x (100 - accept_order.dc_rate) / 100 + accept_order.option_price

顧客名と支払い金額、と表示すること。


Q6-3 OK!
販売管理データベースから、2001年 3月中に各従業員の自動車販売件数を、
販売件数の少ないものから順に表示する SQL 文を記述しなさい。

従業員名と販売件数、と表示すること。


Q6-4 OK!
販売管理データベースから、顧客番号が '1007' の顧客と同じ自動車を購入した顧客の
顧客番号を参照する SQL 文を記述しなさい。
ただし、顧客番号 '1007' は表示しないようにすること。


Q6-5 OK!
まず、販売管理データベースのテーブル employee に次の新入社員のデータを追加する。

表: employee テーブルに追加するデータ e_num 	e_name 	year 	gender 	office
108 	Fujiwara Norio 	2001 	1 	10

テーブル employee とテーブル accept_order を結合して、
従業員名とそれぞれのオプションの価格の合計を表示する SQL 文を記述しなさい。
（データがNULLの場合、オプション売上はNULLで良い。）
従業員、オプション売上と表示すること。

Q7-1 OK!
販売管理データベースから、支払い金額が全ての受注 (受注番号が 1001-1018) に関する
支払い金額の平均より大きい顧客の氏名と住所を表示する SQL 文を記述しなさい。

支払い金額については、6章 1節の実習課題 2 を参照すること。

一回あたりの支払い金額は、次の式で求めるものとする。
(製品の価格) x (100 - (製品の値引率)) / 100 + (オプションの価格)
	= product.price * (100 - accept_order.dc_rate) / 100 + accept_order.option_price


Q7-2
販売管理データベースから、各営業所の売上ランキング表を作成する SQL 文を記述しなさい。

各営業所が管理する顧客の支払い金額を合計したものを各営業所の売上とする。
各営業所が管理する顧客は、customer テーブルを参照すること。
営業所名、売上金額と表示すること。

Q7-3
販売管理データベースから、3台以上の自動車を販売した従業員の名前を表示する SQL 文を記述しなさい。


Q8-1
販売管理データベースから、1月始めから 3月末までの受注で、各月の売上台数を表示させる SQL 文を記述しなさい。
月名、売上台数と表示すること。


Q8-2
販売管理データベースから、顧客に対する販売を担当した従業員が所属する営業所と、顧客を管理する営業所が同じかどうかを調べる目的で、
顧客名、顧客を管理する営業所名、顧客に販売を担当した従業員名、その従業員が所属する営業所を表示させる SQL 文を記述しなさい。
ただし、表示する顧客は担当従業員が所属する営業所と、顧客を管理する営業所が異なるもののみを表示するものとする。


Q9-1
8章実習課題 1 で作成した SQL 文をもとに、ビューを作成しなさい。

ビュー名は MonthCarsListView とする。
select * from MonthCarsListView; としたときに、8章実習課題 1 の結果と同じになるようにすればよい。


Q9-2
8章の実習課題 2 で作成した SQL 文をもとに、ビューを作成しなさい。

ビュー名は OfficeCheckView とする。
select * from OfficeCheckView; としたときに、8章の実習課題 2 の結果と同じになるようにすればよい。


Q9-3
実習課題 1 で作成したビューを利用して、売上台数の最大、最小、平均を表示する SQL 文を記述しなさい。
最大、最小、平均と表示すること。